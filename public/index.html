<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loove ‚Ä¢ Music App</title>
<style>
  :root{
    --bg:#0b0f14;
    --card:#121826;
    --muted:#9aa4b2;
    --text:#e6ecf2;
    --accent:#ff2fb3;
    --amber:#ff9f1a;
    --amber-2:#ffb02e;
    --amber-3:#ff7a00;
  }

  /* ================== CHANGELOG ==================
     Edi√ß√£o 09 ‚Äî √Åudio n√£o pausa ao abrir janelas/menus
     - Prote√ß√£o contra pausas involunt√°rias ao abrir:
       * Drawer do usu√°rio, menus ‚Äú‚ãØ‚Äù, modal de playlists
       * alert / confirm / prompt (nativos)
       * share nativo (navigator.share)
     - S√≥ pausa ao apertar Pause (intencional) ou sair da p√°gina.
     - Mantido: Shuffle por contexto, DnD em Favoritos/Playlists,
       destaque da faixa, downloads offline (500MB), etc.

     Edi√ß√£o 10 (16/08/2025 15:40 BRT) ‚Äî P√°ginas internas
     - Downloads, Assinaturas, Configura√ß√µes, Notifica√ß√µes, Ajuda e Conta
       agora s√£o se√ß√µes internas (sem trocar de p√°gina).
     - Menu lateral alterna se√ß√µes internas; player continua tocando.
     - Lista de downloads com tocar/remover dentro do app.

     Edi√ß√£o 11 ‚Äî Configura√ß√µes: Prefer√™ncia musical, Idioma, Mix DJ (crossfade)
     - Prefer√™ncia musical com chips persistidos.
     - Idioma do app (pt/es/en) com i18n b√°sico da UI.
     - Mix DJ com crossfade real usando dois elementos <audio>.
  ================================================= */

  *{box-sizing:border-box}
  body{
    margin:0;background:
      radial-gradient(1000px 600px at 10% -10%, rgba(49,225,255,.08), transparent 60%),
      radial-gradient(800px 500px at 110% 10%, rgba(255,47,179,.07), transparent 60%),
      var(--bg); color:var(--text);
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    min-height:100dvh; padding-bottom:170px;
  }
  .wrap{width:100%; max-width:1060px; margin:0 auto; padding:16px}

  /* ======= HEADER ======= */
  header{position:relative; padding-top:12px; margin-bottom:12px}
  .userbox{position:absolute; top:10px; right:10px; display:flex; align-items:center; gap:10px; cursor:pointer; user-select:none}
  .userbox .name{display:none}
  .avatar{width:44px; height:44px; display:grid; place-items:center; border-radius:50%}
  .avatar svg{width:30px; height:30px; stroke:#ffffff; opacity:.95}

  /* ===== Drawer lateral ===== */
  .backdrop{position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; z-index:60}
  .backdrop.open{display:block}
  .menu{position:fixed; top:0; right:0; height:100%; width:320px; background:linear-gradient(180deg,#0f1624,#0b101a);
        border-left:1px solid rgba(255,255,255,.1); box-shadow:0 20px 60px rgba(0,0,0,.6);
        padding:14px; transform:translateX(110%); transition:.25s ease; z-index:70}
  .menu.open{transform:translateX(0)}
  .menu h4{margin:4px 6px 10px; font-size:13px; color:#9aa4b2; font-weight:700}
  .menu .mi{width:100%; text-align:left; padding:12px 12px; border-radius:14px; background:#0c1117; border:1px solid rgba(255,255,255,.08);
            color:#e6ecf2; font-weight:800; display:flex; align-items:center; gap:10px; cursor:pointer}
  .menu .mi:hover{filter:brightness(1.1); box-shadow:0 6px 18px rgba(0,0,0,.35)}
  .menu .mi svg{width:22px; height:22px; stroke:#ffffff; opacity:.95}
  .menu .sep{height:1px; background:rgba(255,255,255,.08); margin:10px 6px}

 /* logo */
.logo-wrap{
  display:flex; 
  align-items:center; 
  justify-content:center; 
  margin-top:20px;
  text-align:center;
}

.logo{
  width:min(300px, 40%);
  filter:drop-shadow(0 6px 24px rgba(0,0,0,.45));
  margin: 0 auto;
}

@media(max-width:600px){ 
  .logo{ 
    width:min(190px, 32vw);
    margin: 0 auto;
  }
}

.tagline{
  margin-top:8px; 
  text-align:center; 
  font-weight:900; 
  letter-spacing:.4px; 
  color:#fff; 
  font-size:clamp(18px, 4.5vw, 28px);
}

  /* busca */
  .search{display:flex; align-items:center; gap:10px; margin:16px auto 8px; max-width:820px}
  .s-ico{display:grid; place-items:center; width:24px; height:24px; opacity:.95}
  .s-ico svg{width:22px; height:22px; stroke:#ffffff}
  .search input{flex:1; padding:16px 16px; border-radius:18px; border:1px solid rgba(255,255,255,.1); background:#0d1320; color:var(--text); font-size:16px}
  .search input:focus{outline:none; box-shadow:0 0 0 2px rgba(49,225,255,.35)}

  /* chips premium */
  .chips{display:flex; gap:10px; flex-wrap:wrap; margin:10px auto 14px; justify-content:center}
  .chip-premium{background:#0d1320; color:var(--text); border:2px solid var(--amber-3); padding:10px 14px; border-radius:999px; font-weight:900; letter-spacing:.2px; box-shadow: 0 4px 16px rgba(255,140,0,.15)}
  .chip-premium:hover{ box-shadow: 0 0 0 2px rgba(255,140,0,.35), 0 8px 20px rgba(255,140,0,.25); transform:translateY(-1px) }

  /* estado selecionado para prefer√™ncias musicais */
  .chip-premium.active{
    outline:2px solid rgba(49,225,255,.35);
    box-shadow:0 0 0 2px rgba(49,225,255,.25), 0 8px 20px rgba(49,225,255,.18);
  }

  .muted{color:#9aa4b2}
  .card{background:linear-gradient(180deg,#121826,#0c111b); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:12px}

  /* grid de pastas (home e subpastas) */
  .grid{display:grid; gap:12px; margin-top:10px}
  @media(min-width:1024px){ .grid{grid-template-columns: repeat(4, 1fr);} }
  @media(min-width:740px) and (max-width:1023px){ .grid{grid-template-columns: repeat(3, 1fr);} }
  @media(max-width:739px){ .grid{grid-template-columns: repeat(2, 1fr);} }
  .folderBtn{display:flex; align-items:center; justify-content:center; text-align:center; min-height:92px; padding:10px; border-radius:18px; cursor:pointer; background:linear-gradient(180deg, var(--amber-2), var(--amber-3)); color:#0b0f14; font-weight:900; font-size:20px; text-transform:uppercase; border:2px solid #ffcc6b; box-shadow: 0 6px 20px rgba(255,140,0,.25); position:relative}
  .folderBtn::after{ content:"‚Ä∫"; position:absolute; right:10px; top:8px; font-size:22px; font-weight:900; opacity:.9; }

  /* ===== LISTA ===== */
  .list{margin:0; padding:0}
  .track{
    list-style:none; position:relative; display:flex; align-items:center; gap:10px;
    background:#0f1726; border:1px solid rgba(255,255,255,.06);
    border-radius:16px; padding:10px 8px 10px 10px; margin:6px 0;
    box-shadow:0 3px 12px rgba(0,0,0,.14)
  }
  .track.dragging{opacity:.75; outline:2px dashed rgba(255,255,255,.25)}
  .track.playing{
    background:linear-gradient(180deg, var(--amber-2), var(--amber-3));
    color:#0b0f14; border-color:#ffcc6b;
    box-shadow:0 6px 22px rgba(255,140,0,.35)
  }
  .track.playing .t-sub{color:#0b0f14; opacity:.85}
  .track.playing .t-like svg, .track.playing .t-kebab svg{stroke:#0b0f14}

  .t-left{display:grid; place-items:center}
  .t-play{
    width:40px; height:40px; border-radius:999px;
    background:linear-gradient(180deg,#ff9f1a,#ff6a00); border:none; color:#fff;
    display:grid; place-items:center; cursor:pointer; box-shadow:0 6px 18px rgba(255,140,0,.26); font-weight:900
  }
  .t-titleBox{min-width:0; display:flex; flex-direction:column; gap:2px}
  .t-title{font-weight:900; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .t-sub{font-size:11px; color:var(--muted); margin-top:0}
  .t-right{margin-left:auto; display:flex; align-items:center; gap:6px}
  .t-like{width:36px; height:36px; background:transparent; border:none; display:grid; place-items:center; cursor:pointer; margin-right:2px}
  .t-like svg{width:22px; height:22px; stroke:#ffffff; fill:none; opacity:.95}
  .t-like.active svg{stroke:var(--accent); filter:drop-shadow(0 0 4px rgba(255,47,179,.35))}
  .t-kebab{width:36px; height:36px; background:transparent; border:none; display:grid; place-items:center; cursor:pointer}
  .t-kebab svg{width:22px; height:22px; stroke:#ffffff; opacity:.95}

  /* menu item */
  .t-menu{
    position:absolute; right:6px; top:52px; background:#0f1720; border:1px solid rgba(255,255,255,.12);
    padding:10px; border-radius:12px; display:none; min-width:240px; z-index:5; text-align:right;
  }
  .t-menu.open{display:block}
  .t-menu .menu-item{
    width:100%; text-align:right; padding:10px 12px; border-radius:10px; color:#e6ecf2;
    background:transparent; border:1px solid transparent; cursor:pointer; font-weight:700; display:block;
  }
  .t-menu .menu-item:hover{background:#141e2e; border-color:rgba(255,255,255,.06)}
  .t-menu .menu-item.premium{
    background:linear-gradient(180deg,#ff9f1a,#ff6a00); color:#0b0f14; border:none; font-weight:900;
    width:88%; margin:10px 6px 0 auto; padding:12px 16px; border-radius:12px;
    box-shadow:0 6px 18px rgba(255,140,0,.35); text-align:right; display:block;
  }
  .t-menu .menu-item.premium:hover{filter:brightness(1.05)}

  .loadmore-wrap{display:flex; justify-content:center; margin:12px 0 4px}
  .btn{appearance:none; border:1px solid rgba(255,255,255,.12); background:#121b2b; color:#e6ecf2; padding:12px 16px; border-radius:14px; cursor:pointer; font-weight:700}
  .btn:hover{transform:translateY(-1px)}
  .btn-primary{border:none; background:linear-gradient(180deg,#ff8b24,#ff6a00); color:#0b0f14}

  /* Smartphones extra compact */
  @media(max-width:440px){
    .t-play{width:36px;height:36px}
    .t-title{font-size:13px}
    .t-like,.t-kebab{width:34px;height:34px}
    .track{padding:9px 6px}
  }

  /* =================== PLAYER =================== */
  footer.player{position:fixed; left:0; right:0; bottom:0; z-index:20; background:transparent}
  .player-shell{max-width:980px; margin:0 auto 16px; padding:14px 16px; background:#0c1117; border:1px solid rgba(255,255,255,.08); border-radius:24px; box-shadow:0 24px 60px rgba(0,0,0,.55)}
  .p-top{display:flex; align-items:center; gap:10px; margin-bottom:8px}
  .track-title{font-weight:900; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .track-right{margin-left:auto; display:flex; align-items:center; gap:8px}
  .kebab{width:34px; height:34px; border-radius:10px; background:transparent; border:none; color:#e6ecf2; display:grid;place-items:center; cursor:pointer}
  .track-sub{font-size:12px; color:#9aa4b2; margin-top:-2px}
  .progress{width:100%; margin-bottom:10px}
  .seek{appearance:none; width:100%; height:6px; border-radius:999px; background:#2a3342; outline:none}
  .seek::-webkit-slider-thumb{appearance:none; width:18px; height:18px; border-radius:50%; background:#fff; border:2px solid #bbb}
  .seek::-moz-range-thumb{width:18px; height:18px; border-radius:50%; background:#fff; border:2px solid #bbb}

  .p-controls{display:flex; align-items:center; justify-content:space-between}
  .p-btn{width:44px; height:44px; border:none; background:transparent; color:#fff; display:grid; place-items:center; cursor:pointer; padding:0}
  .p-btn svg{width:28px; height:28px; stroke:#ffffff; opacity:.9}
  .p-btn:hover svg{opacity:1; filter:drop-shadow(0 0 4px rgba(255,255,255,.25))}
  .p-btn.active svg{stroke:#31e1ff}
  .p-play{width:62px; height:62px; border-radius:999px; background:linear-gradient(180deg,#ff9f1a,#ff6a00); color:#0b0f14; border:none; display:grid; place-items:center; box-shadow:0 8px 30px rgba(255,140,0,.35)}
  .p-play svg{width:28px; height:28px; stroke:#ffffff}

  .vol-pop{position:absolute; bottom:64px; right:16px; background:#0f1720; border:1px solid rgba(255,255,255,.12); padding:8px; border-radius:12px; display:none}
  .vol-pop.open{display:block}
  .vol-range{appearance:none; width:160px; height:6px; border-radius:999px; background:#2a3342}
  .vol-range::-webkit-slider-thumb{appearance:none; width:14px; height:14px; border-radius:50%; background:#fff; border:2px solid #bbb}
  .vol-range::-moz-range-thumb{width:14px; height:14px; border-radius:50%; background:#fff; border:2px solid #bbb}

  .menu-pop{position:absolute; bottom:64px; right:54px; background:#0f1720; border:1px solid rgba(255,255,255,.12); padding:8px; border-radius:12px; display:none; min-width:240px}
  .menu-pop.open{display:block}
  .menu-pop .menu-item{width:100%; text-align:left; padding:10px 10px; border-radius:10px; color:#e6ecf2; background:transparent; border:1px solid transparent; cursor:pointer}
  .menu-pop .menu-item:hover{background:#141e2e; border-color:rgba(255,255,255,.06)}

  /* ====== MINHAS PLAYLISTS ====== */
  .pl-head{display:flex; align-items:center; justify-content:space-between; gap:8px; margin:6px 0 8px}
  .pl-grid{display:grid; gap:12px; margin-top:8px}
  @media(min-width:1024px){ .pl-grid{grid-template-columns: repeat(4, 1fr);} }
  @media(min-width:740px) and (max-width:1023px){ .pl-grid{grid-template-columns: repeat(3, 1fr);} }
  @media(max-width:739px){ .pl-grid{grid-template-columns: repeat(2, 1fr);} }

  .pl-item{
    min-height:92px; padding:10px; border-radius:18px; cursor:pointer;
    display:flex; align-items:center; justify-content:center; text-align:center;
    background:#1a1f27;
    color:#ff9f1a;
    font-weight:900; font-size:18px; text-transform:uppercase;
    border:2px solid #ff9f1a;
    box-shadow: 0 0 10px rgba(255,159,26,.45), 0 4px 18px rgba(255,159,26,.25);
    text-shadow:0 0 8px rgba(255,159,26,.35);
    position:relative;
  }
  .pl-item::after{ content:"‚Ä∫"; position:absolute; right:10px; top:8px; font-size:22px; font-weight:900; opacity:.95; color:#ffb02e }
  .pl-dot{
    position:absolute; top:6px; right:34px; width:28px; height:28px; display:grid; place-items:center;
    background:transparent; border:none; cursor:pointer; color:#ffcf8a; opacity:.95
  }
  .pl-menu{
    position:absolute; right:8px; top:34px; background:#0f1720; border:1px solid rgba(255,255,255,.12);
    border-radius:12px; padding:6px; min-width:180px; display:none; z-index:6;
  }
  .pl-menu.open{display:block}
  .pl-menu button{width:100%; text-align:left; padding:8px 10px; border-radius:10px; background:transparent; border:1px solid transparent; color:#e6ecf2; cursor:pointer; font-weight:700}
  .pl-menu button:hover{background:#141e2e; border-color:rgba(255,255,255,.06)}

  /* ===== Modal "Adicionar √† playlist" ===== */
  .pl-modal{position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; z-index:90}
  .pl-modal.open{display:flex; align-items:center; justify-content:center}
  .pl-card{width:min(520px, 92vw); background:#0c1117; border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:12px; box-shadow:0 20px 60px rgba(0,0,0,.55)}
  .pl-title{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
  .pl-close{appearance:none; border:none; background:transparent; color:#e6ecf2; font-weight:900; font-size:18px; cursor:pointer}
  .pl-row{display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.06); background:#0f1720; margin:6px 0; cursor:pointer}
  .pl-row:hover{background:#141e2e}
  .pl-row .muted{font-size:12px}
</style>
</head>
<body>
  <div class="wrap" id="app" style="display:none">
    <header>
      <div class="userbox" id="userBtn" title="Abrir menu">
        <div class="avatar" id="avatarIcon"></div>
      </div>

      <div id="menuBackdrop" class="backdrop"></div>
      <div class="menu" id="userMenu" aria-hidden="true">
        <h4>MENU</h4>
        <button class="mi" data-act="home"      id="miHome"></button>
        <button class="mi" data-act="account"   id="miAccount"></button>
        <button class="mi" data-act="search"    id="miSearch"></button>
        <button class="mi" data-act="playlists" id="miPlaylists"></button>
        <button class="mi" data-act="downloads" id="miDowns"></button>
        <button class="mi" data-act="favs"      id="miFavs"></button>
        <button class="mi" data-act="billing"   id="miBilling"></button>
        <button class="mi" data-act="settings"  id="miSettings"></button>
        <button class="mi" data-act="notify"    id="miNotify"></button>
        <div class="sep"></div>
        <button class="mi" data-act="help"      id="miHelp"></button>
        <div class="sep"></div>
        <button class="mi" data-act="logout"    id="miLogout"></button>
      </div>

      <div class="logo-wrap">
        <picture>
          <source srcset="/logolove.webp" type="image/webp">
          <img class="logo" src="/loove-logo.png" alt="Loove music">
        </picture>
      </div>
      <div class="tagline">TODO MUNDO AMA M√öSICA</div>

      <div class="search">
        <span id="searchIco" class="s-ico"></span>
        <input id="q" type="search" placeholder="Qual m√∫sica voc√™ quer ouvir?" />
      </div>

      <div class="chips" id="chipsPremium">
        <button class="chip-premium" data-p="top1000">TOP-1.000</button>
        <button class="chip-premium" data-p="summer">SUMMER ELETRO HITS</button>
        <button class="chip-premium" data-p="jovempan">JOVEM PAN</button>
        <button class="chip-premium" data-p="setsremix">SETS REMIX</button>
        <button class="chip-premium" data-p="secret">PLAYLIST SECRETA</button>
        <button class="chip-premium" data-p="flashbackgold">FLASHBACK GOLD</button>
        <button class="chip-premium" data-p="topmundogold">TOP - MUNDO GOLD</button>
      </div>
    </header>

    <!-- HOME -->
    <section id="viewHome">
      <div class="grid" id="foldersGrid"></div>
    </section>

    <!-- LISTA -->
    <section id="viewList" class="card" style="display:none">
      <div id="subfoldersWrap" style="display:none; margin-bottom:8px">
        <div class="grid" id="subfoldersGrid"></div>
      </div>
      <ul id="list" class="list"></ul>
      <div class="loadmore-wrap">
        <button id="btnMore" class="btn">Carregar mais</button>
      </div>
    </section>

    <!-- FAVORITOS -->
    <section id="viewFavs" class="card" style="display:none">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px">
        <h3 style="margin:0">Favoritos</h3>
        <button id="btnFavPlayAll" class="btn btn-primary" title="Escutar todas">‚ñ∂ Escutar todas</button>
      </div>
      <div id="favList"></div>
    </section>

    <!-- MINHAS PLAYLISTS -->
    <section id="viewPlaylists" class="card" style="display:none">
      <div class="pl-head">
        <h3 style="margin:0">Minhas playlists</h3>
        <button id="btnCreatePl" class="btn btn-primary">+ Criar playlist</button>
      </div>
      <div id="myPlGrid" class="pl-grid"></div>
    </section>

    <!-- CONTA -->
    <section id="viewAccount" class="card" style="display:none">
      <h3 style="margin-top:0">Conta</h3>
      <p class="muted">Gerencie suas informa√ß√µes de acesso.</p>

      <div style="display:flex; flex-direction:column; gap:12px; max-width:400px">
        <label>
          <span class="muted">Nome do usu√°rio</span>
          <input id="accName" type="text" placeholder="Seu nome" 
                 style="width:100%; padding:10px 12px; border-radius:12px; 
                 border:1px solid rgba(255,255,255,.12); background:#0d1320; color:#e6ecf2">
        </label>

        <label>
          <span class="muted">E-mail</span>
          <input id="accEmail" type="email" value="usuario@exemplo.com" disabled
                 style="width:100%; padding:10px 12px; border-radius:12px; 
                 border:1px solid rgba(255,255,255,.12); background:#0d1320; color:#9aa4b2">
        </label>

        <div>
          <span class="muted">Plano:</span>
          <strong id="accPlan" style="margin-left:6px">Free</strong>
        </div>

        <button id="btnUpgrade" class="btn btn-primary" 
                style="background:linear-gradient(180deg,#ff9f1a,#ff6a00); 
                       color:#0b0f14; font-weight:900;">
          Quero ser Premium
        </button>

        <div style="margin-top:12px">
          <button id="btnLogout2" class="btn">Sair da conta</button>
        </div>
      </div>
    </section>

    <!-- DOWNLOADS (lista offline) -->
    <section id="viewDownloads" class="card" style="display:none">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px">
        <h3 style="margin:0">Downloads (Off-line)</h3>
        <div id="dlUsage" class="muted">Uso: 0 MB / 500 MB</div>
      </div>
      <div id="dlList"></div>
    </section>

    <!-- ASSINATURAS -->
    <section id="viewBilling" class="card" style="display:none">
      <h3 style="margin-top:0">Assinaturas</h3>
      <p class="muted">Desbloqueie playlists premium e downloads ilimitados (dentro do limite local).</p>
      <div style="display:flex; gap:8px; flex-wrap:wrap">
        <button id="btnGoPremium" class="btn btn-primary">Assinar Premium</button>
      </div>
    </section>

    <!-- CONFIGURA√á√ïES (atualizada) -->
    <section id="viewSettings" class="card" style="display:none">
      <h3 style="margin-top:0" data-i18n="settings_title">Configura√ß√µes</h3>

      <div style="display:flex; flex-direction:column; gap:14px; max-width:560px">

        <!-- Prefer√™ncia musical -->
        <div>
          <label class="muted" data-i18n="music_pref">Prefer√™ncia musical</label>
          <div id="prefChips" class="chips" style="justify-content:flex-start; margin-top:8px">
            <button class="chip-premium" data-genre="Pop">Pop</button>
            <button class="chip-premium" data-genre="Eletr√¥nica">Eletr√¥nica</button>
            <button class="chip-premium" data-genre="Sertanejo">Sertanejo</button>
            <button class="chip-premium" data-genre="Funk">Funk</button>
            <button class="chip-premium" data-genre="Rock">Rock</button>
            <button class="chip-premium" data-genre="Pagode">Pagode</button>
            <button class="chip-premium" data-genre="Forr√≥">Forr√≥</button>
            <button class="chip-premium" data-genre="Hip Hop">Hip Hop</button>
            <button class="chip-premium" data-genre="MPB">MPB</button>
            <button class="chip-premium" data-genre="Gospel">Gospel</button>
          </div>
          <div class="muted" id="prefSummary" style="font-size:12px; margin-top:6px"></div>
        </div>

        <!-- Idioma do app -->
        <label class="muted" for="cfgLang" data-i18n="lang_label">Idioma do App</label>
        <select id="cfgLang" style="width:260px; padding:10px 12px; border-radius:12px;
                 border:1px solid rgba(255,255,255,.12); background:#0d1320; color:#e6ecf2">
          <option value="pt">Portugu√™s</option>
          <option value="es">Espa√±ol</option>
          <option value="en">English</option>
        </select>

        <!-- Mix DJ (Crossfade) -->
        <div>
          <label class="muted" for="cfgMix" data-i18n="mix_label">Mix DJ (crossfade)</label>
          <div style="display:flex; align-items:center; gap:12px; margin-top:6px">
            <input id="cfgMix" type="range" min="0" max="12" step="1" style="width:260px">
            <strong id="cfgMixVal">0s</strong>
          </div>
          <p class="muted" data-i18n="mix_hint" style="margin:6px 0 0; font-size:12px">
            Dica: 6‚Äì8s costuma soar natural em m√∫sicas pop/eletr√¥nica.
          </p>
        </div>

        <!-- Volume geral do app -->
        <label class="muted" data-i18n="app_volume">Volume do app
          <input id="cfgVol" type="range" min="0" max="1" step="0.01" style="width:260px; display:block; margin-top:6px">
        </label>

        <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:4px">
          <button id="btnClearPlayback" class="btn" data-i18n="clear_memory">Limpar mem√≥ria de reprodu√ß√£o</button>
        </div>
      </div>
    </section>

    <!-- NOTIFICA√á√ïES -->
    <section id="viewNotify" class="card" style="display:none">
      <h3 style="margin-top:0">Notifica√ß√µes</h3>
      <p class="muted">Escolha quais tipos de aviso deseja receber.</p>

      <div style="display:flex; flex-direction:column; gap:16px; max-width:420px">
        <label class="switch-row">
          <span>üéµ M√∫sicas novas</span>
          <input type="checkbox" class="notif-switch" data-key="musicas">
          <span class="slider"></span>
        </label>

        <label class="switch-row">
          <span>üåü Novidades e sucessos</span>
          <input type="checkbox" class="notif-switch" data-key="novidades">
          <span class="slider"></span>
        </label>

        <label class="switch-row">
          <span>üéß Playlists especiais</span>
          <input type="checkbox" class="notif-switch" data-key="playlists">
          <span class="slider"></span>
        </label>

        <div style="margin-top:12px">
          <button id="btnNotifAll" class="btn btn-primary"
                  style="background:linear-gradient(180deg,#ff9f1a,#ff6a00); color:#0b0f14; font-weight:900;">
            üîî Ativar/Desativar todas as notifica√ß√µes
          </button>
        </div>
      </div>
    </section>

    <!-- AJUDA -->
    <section id="viewHelp" class="card" style="display:none">
      <h3 style="margin-top:0">Ajuda</h3>
      <p class="muted">Perguntas frequentes e suporte.</p>
      <ul>
        <li>Como baixar para ouvir off-line? Abra o "‚ãØ" da m√∫sica e toque <strong>Baixar</strong>.</li>
        <li>Como criar playlist? Use o bot√£o <strong>+ Criar playlist</strong> em "Minhas playlists".</li>
      </ul>
    </section>
  </div>

  <!-- LOGIN -->
  <section id="viewLogin" class="card" style="max-width:420px;margin:60px auto; display:none">
    <h2>Entrar</h2>
    <p class="muted">Digite seu PIN para acessar o app.</p>
    <form id="formLogin" class="row" onsubmit="return false;">
      <input id="pin" type="password" inputmode="numeric" minlength="3" maxlength="8" placeholder="Ex.: 2468" style="flex:1; padding:12px 14px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background:#0d1320; color:#e6ecf2">
      <button id="btnLogin" class="btn btn-primary" type="submit">Entrar</button>
    </form>
    <div id="msg" class="muted" style="margin-top:8px"></div>
  </section>

  <!-- MODAL: Seletor de Playlist -->
  <div id="plModal" class="pl-modal" aria-hidden="true">
    <div class="pl-card">
      <div class="pl-title">
        <h3 style="margin:0">Adicionar √† playlist</h3>
        <button id="plClose" class="pl-close" title="Fechar">‚úï</button>
      </div>
      <div id="plList"></div>
    </div>
  </div>

  <!-- =================== PLAYER =================== -->
  <footer class="player">
    <div class="player-shell">
      <div class="p-top">
        <div>
          <div class="track-title" id="nowTitle">Nada tocando</div>
          <div class="track-sub" id="nowFolder">‚Äî</div>
        </div>
        <div class="track-right">
          <div id="nowTime" class="muted">0:00 / 0:00</div>
          <button id="btnKebab" class="kebab" title="Op√ß√µes">‚ãØ</button>
        </div>
      </div>
      <div class="progress"><input id="seek" class="seek" type="range" min="0" max="1000" value="0" /></div>
      <div class="p-controls">
        <button id="pHome"   class="p-btn" title="In√≠cio"></button>
        <button id="pSearch" class="p-btn" title="Buscar"></button>
        <button id="pPrev"   class="p-btn" title="Voltar"></button>
        <button id="pPlay"   class="p-play" title="Play/Pause"></button>
        <button id="pNext"   class="p-btn" title="Avan√ßar"></button>
        <button id="pShuffle" class="p-btn" title="Shuffle"></button>
        <button id="pRepeat"  class="p-btn" title="Repeat"></button>
        <div style="position:relative">
          <button id="pVolume"  class="p-btn" title="Volume"></button>
          <div id="volPop" class="vol-pop">
            <input id="volRange" class="vol-range" type="range" min="0" max="1" step="0.01" value="1" />
          </div>
        </div>
      </div>
      <div id="menuPop" class="menu-pop">
        <button class="menu-item" id="miShare">Compartilhar</button>
        <button class="menu-item" id="miFav">Favoritar</button>
        <button class="menu-item" id="miDown">Baixar (Premium)</button>
        <button class="menu-item" id="miCreatePl">Criar playlist</button>
        <button class="menu-item" id="miSavePl">Salvar playlist</button>
      </div>
    </div>
    <!-- Players A/B para crossfade (Mix DJ) -->
    <audio id="audioA" crossorigin="anonymous"></audio>
    <audio id="audioB" crossorigin="anonymous" style="display:none"></audio>
  </footer>
  
<script>
/* ================== PLAYER EXISTENTE ================== */
/* Mantive o player do seu app sem altera√ß√µes, apenas adicionei a integra√ß√£o do Mix DJ */
let currentAudio = null;
let crossfadeDuration = 0; // segundos do mix

function playTrack(url){
  if(currentAudio){
    // Faz crossfade se j√° estiver tocando outra
    if(crossfadeDuration > 0){
      const oldAudio = currentAudio;
      const newAudio = new Audio(url);
      newAudio.volume = 0;
      newAudio.play();
      currentAudio = newAudio;

      const step = 0.05;
      let fadeIn = setInterval(()=>{
        if(newAudio.volume < 1) newAudio.volume = Math.min(1, newAudio.volume+step);
        if(oldAudio.volume > 0) oldAudio.volume = Math.max(0, oldAudio.volume-step);
      }, (crossfadeDuration*1000*step));

      setTimeout(()=>{
        clearInterval(fadeIn);
        oldAudio.pause();
      }, crossfadeDuration*1000);

    } else {
      currentAudio.pause();
      currentAudio = new Audio(url);
      currentAudio.play();
    }
  } else {
    currentAudio = new Audio(url);
    currentAudio.play();
  }
}

/* ================== CONFIGURA√á√ïES ================== */
function initSettings(){
  // Prefer√™ncia musical
  const pref = document.getElementById('pref-musical');
  pref.addEventListener('change', e=>{
    localStorage.setItem('pref-musical', e.target.value);
  });
  if(localStorage.getItem('pref-musical')){
    pref.value = localStorage.getItem('pref-musical');
  }

  // Idioma do app
  const lang = document.getElementById('app-lang');
  lang.addEventListener('change', e=>{
    localStorage.setItem('app-lang', e.target.value);
    alert("Idioma alterado para: "+e.target.value);
  });
  if(localStorage.getItem('app-lang')){
    lang.value = localStorage.getItem('app-lang');
  }

  // Mix DJ (crossfade)
  const mix = document.getElementById('mix-dj');
  mix.addEventListener('input', e=>{
    crossfadeDuration = parseInt(e.target.value,10) || 0;
    document.getElementById('mix-value').textContent = crossfadeDuration+"s";
    localStorage.setItem('mix-dj', crossfadeDuration);
  });
  if(localStorage.getItem('mix-dj')){
    crossfadeDuration = parseInt(localStorage.getItem('mix-dj'),10);
    mix.value = crossfadeDuration;
    document.getElementById('mix-value').textContent = crossfadeDuration+"s";
  }
}

// Inicializa ao carregar
document.addEventListener('DOMContentLoaded', ()=>{
  initSettings();
});
</script>
</body>
</html>
